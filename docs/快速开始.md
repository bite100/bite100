# P2P DEX 快速开始

> **重要**：**节点入网无任何条件**，无需白名单、质押或邀请，任何节点都可以自由加入网络。

## 一键启动（推荐）

### Windows

```powershell
.\scripts\start-dev.ps1
```

### Linux / macOS

```bash
chmod +x scripts/start-dev.sh
./scripts/start-dev.sh
```

启动后访问：http://localhost:5173

---

## 手动启动

### 1. 启动节点

**方式一：Docker（推荐）**

```bash
docker-compose up --build
```

**方式二：本地运行**

```bash
# 撮合节点
cd node
go run ./cmd/node -config config.yaml

# 另开终端，启动存储节点
go run ./cmd/node -config config.yaml -port 4002 -connect /ip4/127.0.0.1/tcp/4001/p2p/<撮合节点PeerID>
```

### 2. 启动前端

```bash
cd frontend
npm install
npm run dev
```

访问：http://localhost:5173

---

## 功能测试

### 1. 连接钱包

点击「连接钱包」，选择 MetaMask，切换到 Sepolia 测试网。

### 2. 获取测试代币

访问 [Sepolia Faucet](https://sepoliafaucet.com/) 获取测试 ETH。

### 3. 存入资金

在「存款」页面：
- 选择 TKA 或 TKB
- 输入数量
- 点击「存款」

### 4. 提交订单

在「交易」页面：
- 选择交易对：TKA/TKB
- 选择方向：买入/卖出
- 输入价格和数量
- 点击「提交订单」

### 5. 查看订单簿

实时订单簿会通过 WebSocket 自动更新，显示：
- 买盘（绿色）
- 卖盘（红色）
- 价差

### 6. 查看成交

成交后会显示：
- 成交价格
- 成交数量
- 成交时间
- 链上交易哈希（点击可查看）

---

## 多节点测试

### 启动 3 个节点

```bash
# 终端 1：撮合节点
cd node
go run ./cmd/node -config config.yaml

# 终端 2：存储节点
go run ./cmd/node -config config.yaml -port 4002 -connect <撮合节点地址>

# 终端 3：中继节点
go run ./cmd/node -config config.yaml -port 4003 -connect <撮合节点地址>
```

### 测试订单广播

在前端提交订单后，观察所有节点日志，应该看到：
- 撮合节点：收到订单 → 撮合 → 广播成交
- 存储节点：收到订单 → 持久化
- 中继节点：收到订单 → 转发

---

## 常见问题

### Q: 节点无法连接？

A: 检查防火墙设置，确保端口 4001-4003 开放。

### Q: WebSocket 连接失败？

A: 确保节点 API 已启动（`config.yaml` 中 `api.listen: ":8080"`）。

### Q: 订单未撮合？

A: 检查：
1. 价格是否匹配（买价 ≥ 卖价）
2. 节点类型是否为 `match`
3. 交易对配置是否正确

### Q: 链上结算失败？

A: 检查：
1. 钱包余额是否充足
2. 代币是否已授权给 Vault
3. Settlement 合约是否已部署

---

## 下一步

- 📖 阅读[完整指南](P2P节点整合交易撮合指南.md)
- 🔧 查看[技术架构](技术架构说明.md)
- 🚀 部署到[主网](主网部署指南.md)
- 💬 加入社区讨论

---

## 获取帮助

- GitHub Issues：https://github.com/P2P-P2P/p2p/issues
- 文档：https://github.com/P2P-P2P/p2p/tree/main/docs
